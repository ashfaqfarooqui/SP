<div class="header">
  <div class="btn-toolbar" role="toolbar">
    <button type="button" class="btn btn-default" ng-click="findRelations()"><span class="glyphicon glyphicon-refresh"></span> Identify</button>
    <button type="button" class="btn btn-default" ng-click="getSOP()"><span class="glyphicon glyphicon-new-window"></span> sopViewer</button>
  </div> <!-- end of toolbar -->
</div> <!-- end of header -->

<div class="content">
  <div class="content-wrapper">
    <p ng-if="latestMapVersion > 0"><small>The latest map was generated on model version {{latestMapVersion}}.<br />
    The current model version is {{spTalker.activeModel.version}}.</small></p>
    <p ng-if="latestMapVersion === 0"><small>There is no generated map available.</small></p>

    <div style="overflow: hidden;">

      <h4>Options</h4>

      <div></div>

      <div class="col-md-6">
        <h5>Operations</h5>
        <table class="table">
          <thead>
            <tr>
              <th style="width: 60px;"><input type="checkbox" ng-model="checkAllOps" ng-change="checkUncheckAll(opSelection, checkAllOps)"></th>
              <th>Name</th>
            </tr>
          </thead>
        </table>
        <div class="relation-item-table">
          <table class="table">
            <tbody>
            <tr ng-repeat="(id, op) in spTalker.items | with: { isa: 'Operation' }" ng-class-odd="'odd-row'">
              <td style="width: 60px;"><input type="checkbox" ng-init="opSelection[id] = true" ng-model="opSelection[id]" ng-change="correctCheckAllBox(opSelection, 'checkAllOps')"></td><td>{{op.name}}</td>
            </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="col-md-6">
        <h5>Groups</h5>
        <table class="table"><thead><tr><th style="width: 60px;"><input type="checkbox" ng-model="checkAllGroups" ng-change="checkUncheckAll(groupSelection, checkAllGroups)"></th><th>Name</th></tr></thead></table>
        <div class="relation-item-table">
          <table class="table">
            <tbody>
            <tr ng-repeat="group in spTalker.activeModel.attributes.conditionGroups" ng-class-odd="'odd-row'">
              <td style="width: 60px;"><input type="checkbox" ng-init="groupSelection[group] = true" ng-model="groupSelection[group]" ng-change="correctCheckAllBox(groupSelection, 'checkAllGroups')"></td><td>{{group}}</td>
            </tr>
            <tr ng-repeat="sopSpec in spTalker.items | with: { isa: 'SOPSpec' }" ng-class-odd="'odd-row'">
              <td style="width: 60px;"><input type="checkbox" ng-init="groupSelection[sopSpec.name] = true" ng-model="groupSelection[sopSpec.name]" ng-change="correctCheckAllBox(groupSelection, 'checkAllGroups')"></td><td>{{sopSpec.name}}</td>
            </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="col-md-12">
        <h5>Init and goal</h5>
        <table class="table"><thead><tr><th style="width: 34%;">Statevar</th><th style="width: 33%;">Init</th><th style="width: 33%;">Goal</th></tr></thead></table>
        <div class="relation-item-table">
          <table class="table">
            <tbody>
              <tr ng-repeat="(id, thing) in (things = (spTalker.items | with: { isa: 'Thing' }))" ng-class-odd="'odd-row'">
                <td style="width: 34%;">{{thing.name}}</td>
                <td style="width: 33%;"><input class="form-control input-sm" type="text" ng-init="initState[id] = thing.attributes.stateVariable.init" ng-model="initState[id]"></td>
                <td style="width: 33%;"><input class="form-control input-sm" type="text" ng-init="goalState[id] = thing.attributes.stateVariable.goal" ng-model="goalState[id]"></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

    </div>

    <div>{{soperror}}</div>
    <h4>Found relations</h4>
    <div ng-repeat="sop in relations">
        {{sop.isa}}: {{getOpsFromSOP(sop)}}
    </div>

  </div> <!-- end of content-wrapper -->
</div> <!-- end of content -->